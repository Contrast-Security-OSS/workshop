# Workshop setup

In this directory, we have a setup script that creates Kubernetes files for each student.

We realize we don't know if we'll have a few, or several dozen users, so the idea here is to create the infrastructure via script, given a list.

While we can make this an uber-script, with all options included, we're not starting that way.

## How to use


In short, you will look at invocations of this form:

```
./setup.sh 
  -Y ~/.contrast/demo/contrast_security.yaml  \
  -U marcomorales \
  -p companyname \
  -i mm
``` 

This script above will take the values from `contrast_security.yaml` and render output files.  The script is intended to be called multiple times with a new set of inputs:


```
./setup.sh -Y test/contrast_security-username1.yaml -U username1 -p companyname1 -i un1
./setup.sh -Y test/contrast_security-username2.yaml -U username2 -p companyname2 -i un2
./setup.sh -Y test/contrast_security-username3.yaml -U username3 -p companyname3 -i un3
./setup.sh -Y test/contrast_security-username3.yaml -U username4 -p companyname3 -i un4
./setup.sh -Y test/contrast_security-username3.yaml -U username5 -p companyname3 -i un5
``` 

or

```
./setup.sh -Y test/contrast_security-username1.yaml -U john.doe -p companyname -i jd1
./setup.sh -Y test/contrast_security-username1.yaml -U jane.doe -p companyname -i jd2
./setup.sh -Y test/contrast_security-username1.yaml -U abe.froman -p companyname -i af
./setup.sh -Y test/contrast_security-username1.yaml -U abe.lincon -p companyname -i al
./setup.sh -Y test/contrast_security-username1.yaml -U fbueller -p companyname -i fb 
``` 

At this time, this list of commands are not auto-generated by a script or process.  We're assuming you have a handle on acquiring the contrast_security.yaml files for each user.   Automating the creation of that process is a different project.  So let's assume we have our list of contrast_security.yaml files and users already setup.

## Source files
In this folder, we have a bunch of files named as, `files.template.yaml` that are the base definitions, with a convention of using placeholders denoted by `<<placeholdername>>`

After putting some thought into the various templating options, we went with simple for this iteration.  Simply put, we want to get something running quickly and maybe having each user's output in their respective directory will work to our advantage.

## output files

The results are put into folders named by the user's company and their username `companyname1/un1` `companyname2/un2` `companyname3/un3` and so on.  This is rather convenient since the outputs are all about the same in their naming convention.   This means we can next leverage some commands put into the helper scripts.

### startup.sh

Within each user's directory is a startup script that runs the kubernetes commands for you.  These are for convenience, but maybe they can be plumbed into a CI server somewhere.

### shutdown.sh

Similar to the startup script, we have a shutdown script that we provide out of convenience, also in the user's directory. 